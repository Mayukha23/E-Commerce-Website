'use strict';const a643_0x301c8f=a643_0x3061;(function(_0x486946,_0x435bb4){const _0x1a111a=a643_0x3061,_0x13ed20=_0x486946();while(!![]){try{const _0x2033ef=parseInt(_0x1a111a(0x1a9))/0x1+parseInt(_0x1a111a(0x1c7))/0x2+parseInt(_0x1a111a(0x1c5))/0x3*(parseInt(_0x1a111a(0x1ce))/0x4)+-parseInt(_0x1a111a(0x1b8))/0x5+-parseInt(_0x1a111a(0x1c8))/0x6+parseInt(_0x1a111a(0x1aa))/0x7*(-parseInt(_0x1a111a(0x1e8))/0x8)+parseInt(_0x1a111a(0x1b4))/0x9*(-parseInt(_0x1a111a(0x1e9))/0xa);if(_0x2033ef===_0x435bb4)break;else _0x13ed20['push'](_0x13ed20['shift']());}catch(_0x1b7540){_0x13ed20['push'](_0x13ed20['shift']());}}}(a643_0x3c91,0xbc1b0));Object[a643_0x301c8f(0x1e1)](exports,a643_0x301c8f(0x1a7),{'value':!![]}),exports[a643_0x301c8f(0x1ca)]=void 0x0;const tslib_1=require('tslib');require(a643_0x301c8f(0x1b7));function a643_0x3c91(){const _0x3e9b70=['subject','MAILService','password','socket','save','toString','defineProperty','Settings','__metadata','AES','__param','redirectUrl','remoteAddress','1352SZKKdI','20GupxPj','status','username','__decorate','routing-controllers','lastLogin','design:returntype','{xxxxxx}','token','design:paramtypes','randomatic','storeRedirectUrl','../../../../src/api/core/models/AccessTokenModel','connection','typeorm','__esModule','hashPassword','1263967bnWsPf','41097OTkWtK','AccessToken','EmailTemplate','../../../../src/env','Res','env','LoginLog','headers','prototype','encrypt','5364306wGzuuv','default','email','reflect-metadata','5935575ESxleV','../../../../src/api/core/models/Customer','userId','crypto-js','replace','Body','__importDefault','emailContent','Loggedin\x20successfully.\x20','emailId','jwtSecret','customerId','__awaiter','123GoYzlO','logo','2906016bQCydB','84048owuaIv','Customer','FacebookController','getRepository','oauthData','Login','140380mgufna','getManager','sign','../../../../src/auth/mail.services','send','{name}','findOne','design:type','../../../../src/api/core/models/Setting','../../../../src/api/core/models/EmailTemplate','x-forwarded-for','productDetailData','sendMail'];a643_0x3c91=function(){return _0x3e9b70;};return a643_0x3c91();}const routing_controllers_1=require(a643_0x301c8f(0x1ed)),typeorm_1=require(a643_0x301c8f(0x1a6)),Customer_1=require(a643_0x301c8f(0x1b9)),LoginLog_1=require('../../../../src/api/core/models/LoginLog'),jsonwebtoken_1=tslib_1[a643_0x301c8f(0x1be)](require('jsonwebtoken')),mail_services_1=require(a643_0x301c8f(0x1d1)),EmailTemplate_1=require(a643_0x301c8f(0x1d7)),env_1=require(a643_0x301c8f(0x1ad)),Setting_1=require(a643_0x301c8f(0x1d6)),AccessTokenModel_1=require(a643_0x301c8f(0x1a4));let FacebookController=class FacebookController{constructor(){}[a643_0x301c8f(0x1cd)](_0x1ddb28,_0x321124,_0x21eb92){const _0x53c873=a643_0x301c8f;return tslib_1[_0x53c873(0x1c4)](this,void 0x0,void 0x0,function*(){const _0x494a1e=_0x53c873,_0x305e4e=(0x0,typeorm_1[_0x494a1e(0x1cf)])()[_0x494a1e(0x1cb)](Customer_1[_0x494a1e(0x1c9)]),_0x332ff9=(0x0,typeorm_1[_0x494a1e(0x1cf)])()[_0x494a1e(0x1cb)](EmailTemplate_1[_0x494a1e(0x1ac)]),_0x3531e7=(0x0,typeorm_1['getManager'])()[_0x494a1e(0x1cb)](LoginLog_1['LoginLog']),_0x4f729a=(0x0,typeorm_1['getManager'])()['getRepository'](Setting_1[_0x494a1e(0x1e2)]),_0x102208=yield _0x305e4e[_0x494a1e(0x1d4)]({'where':{'email':_0x1ddb28[_0x494a1e(0x1c1)],'deleteFlag':0x0}});if(!_0x102208){const _0x87ca6c=new Customer_1[(_0x494a1e(0x1c9))](),_0x9a2de5=require(_0x494a1e(0x1a2)),_0x1e501b=_0x9a2de5('0',0x5)[_0x494a1e(0x1e0)]();_0x87ca6c[_0x494a1e(0x1dd)]=yield Customer_1[_0x494a1e(0x1c9)][_0x494a1e(0x1a8)](_0x1e501b),_0x87ca6c['email']=_0x1ddb28[_0x494a1e(0x1c1)],_0x87ca6c[_0x494a1e(0x1eb)]=_0x1ddb28[_0x494a1e(0x1c1)],_0x87ca6c['oauthData']=_0x1ddb28[_0x494a1e(0x1cc)],_0x87ca6c['isActive']=0x1,_0x87ca6c['ip']=(_0x321124[_0x494a1e(0x1b1)][_0x494a1e(0x1d8)]||_0x321124[_0x494a1e(0x1a5)][_0x494a1e(0x1e7)]||_0x321124[_0x494a1e(0x1de)][_0x494a1e(0x1e7)]||_0x321124[_0x494a1e(0x1a5)][_0x494a1e(0x1de)][_0x494a1e(0x1e7)])['split'](',')[0x0];const _0x3d23c0=yield _0x305e4e['save'](_0x87ca6c),_0x4546f9=new LoginLog_1[(_0x494a1e(0x1b0))]();_0x4546f9['customerId']=_0x3d23c0['id'],_0x4546f9[_0x494a1e(0x1c1)]=_0x3d23c0[_0x494a1e(0x1b6)],_0x4546f9['ipAddress']=(_0x321124['headers'][_0x494a1e(0x1d8)]||_0x321124[_0x494a1e(0x1a5)][_0x494a1e(0x1e7)]||_0x321124[_0x494a1e(0x1de)][_0x494a1e(0x1e7)]||_0x321124[_0x494a1e(0x1a5)]['socket'][_0x494a1e(0x1e7)])['split'](',')[0x0];const _0x2f815e=yield _0x3531e7['save'](_0x4546f9),_0x46e162=yield _0x305e4e['findOne']({'where':{'email':_0x3d23c0[_0x494a1e(0x1b6)],'deleteFlag':0x0}});_0x46e162[_0x494a1e(0x1ee)]=_0x2f815e['createdDate'],yield _0x305e4e[_0x494a1e(0x1df)](_0x46e162);const _0x572418=jsonwebtoken_1[_0x494a1e(0x1b5)][_0x494a1e(0x1d0)]({'id':_0x3d23c0['id']},env_1[_0x494a1e(0x1af)]['jwtSecret']),_0x3a6448=(0x0,typeorm_1[_0x494a1e(0x1cf)])()['getRepository'](AccessTokenModel_1[_0x494a1e(0x1ab)]),_0x313b1c=new AccessTokenModel_1[(_0x494a1e(0x1ab))]();_0x313b1c[_0x494a1e(0x1ba)]=_0x3d23c0['id'],_0x313b1c[_0x494a1e(0x1a0)]=_0x572418,yield _0x3a6448[_0x494a1e(0x1df)](_0x313b1c);const _0x94a25e=require(_0x494a1e(0x1bb)),_0x4607d8=_0x94a25e[_0x494a1e(0x1e4)][_0x494a1e(0x1b3)](_0x572418,env_1[_0x494a1e(0x1af)]['cryptoSecret'])[_0x494a1e(0x1e0)](),_0x3dfad2=yield _0x332ff9['findOne']({'where':{'emailTemplateId':0x9}}),_0x420e3e=_0x3dfad2['content'][_0x494a1e(0x1bc)](_0x494a1e(0x1d3),_0x3d23c0['username'])[_0x494a1e(0x1bc)](_0x494a1e(0x19f),_0x1e501b),_0x1d19fe=env_1['env'][_0x494a1e(0x1a3)],_0x53d17c=yield _0x4f729a[_0x494a1e(0x1d4)](),_0x4bec0f={};_0x4bec0f[_0x494a1e(0x1c6)]=_0x53d17c,_0x4bec0f[_0x494a1e(0x1bf)]=_0x420e3e,_0x4bec0f[_0x494a1e(0x1e6)]=_0x1d19fe,_0x4bec0f[_0x494a1e(0x1d9)]=undefined,mail_services_1[_0x494a1e(0x1dc)][_0x494a1e(0x1da)](_0x4bec0f,_0x3d23c0[_0x494a1e(0x1b6)],_0x3dfad2[_0x494a1e(0x1db)],![],![],'');if(_0x3d23c0){const _0x1637b4={'status':0x1,'message':_0x494a1e(0x1c0),'data':{'token':_0x4607d8,'user':_0x3d23c0}};return _0x21eb92[_0x494a1e(0x1ea)](0xc8)[_0x494a1e(0x1d2)](_0x1637b4);}}else{const _0x4951f6=jsonwebtoken_1[_0x494a1e(0x1b5)]['sign']({'id':_0x102208['id']},env_1[_0x494a1e(0x1af)][_0x494a1e(0x1c2)]),_0x2cfdf3=require(_0x494a1e(0x1bb)),_0x1e1705=_0x2cfdf3['AES'][_0x494a1e(0x1b3)](_0x4951f6,env_1['env']['cryptoSecret'])[_0x494a1e(0x1e0)](),_0x48057c=new LoginLog_1['LoginLog']();_0x48057c[_0x494a1e(0x1c3)]=_0x102208['id'],_0x48057c[_0x494a1e(0x1c1)]=_0x102208['email'],_0x48057c['firstName']=_0x102208['firstName'],_0x48057c['ipAddress']=(_0x321124[_0x494a1e(0x1b1)][_0x494a1e(0x1d8)]||_0x321124[_0x494a1e(0x1a5)][_0x494a1e(0x1e7)]||_0x321124[_0x494a1e(0x1de)]['remoteAddress']||_0x321124[_0x494a1e(0x1a5)][_0x494a1e(0x1de)][_0x494a1e(0x1e7)])['split'](',')[0x0];const _0x3833ee=yield _0x3531e7[_0x494a1e(0x1df)](_0x48057c),_0x59398e=yield _0x305e4e[_0x494a1e(0x1d4)]({'where':{'email':_0x102208[_0x494a1e(0x1b6)],'deleteFlag':0x0}});_0x59398e[_0x494a1e(0x1ee)]=_0x3833ee['createdDate'],yield _0x305e4e[_0x494a1e(0x1df)](_0x59398e);const _0x27da5f=(0x0,typeorm_1[_0x494a1e(0x1cf)])()[_0x494a1e(0x1cb)](AccessTokenModel_1[_0x494a1e(0x1ab)]),_0x1423a2=new AccessTokenModel_1[(_0x494a1e(0x1ab))]();_0x1423a2[_0x494a1e(0x1ba)]=_0x102208['id'],_0x1423a2[_0x494a1e(0x1a0)]=_0x4951f6,yield _0x27da5f[_0x494a1e(0x1df)](_0x1423a2);const _0x52f5ec={'status':0x1,'message':'Loggedin\x20successfully.','data':{'token':_0x1e1705,'user':_0x102208}};return _0x21eb92[_0x494a1e(0x1ea)](0xc8)[_0x494a1e(0x1d2)](_0x52f5ec);}});}};function a643_0x3061(_0xcf57b0,_0x500b76){const _0x3c9148=a643_0x3c91();return a643_0x3061=function(_0x306183,_0x1ff8ee){_0x306183=_0x306183-0x19e;let _0x3957df=_0x3c9148[_0x306183];return _0x3957df;},a643_0x3061(_0xcf57b0,_0x500b76);}tslib_1[a643_0x301c8f(0x1ec)]([(0x0,routing_controllers_1['Post'])('/'),tslib_1[a643_0x301c8f(0x1e5)](0x0,(0x0,routing_controllers_1[a643_0x301c8f(0x1bd)])({'validate':!![]})),tslib_1[a643_0x301c8f(0x1e5)](0x1,(0x0,routing_controllers_1['Req'])()),tslib_1[a643_0x301c8f(0x1e5)](0x2,(0x0,routing_controllers_1[a643_0x301c8f(0x1ae)])()),tslib_1[a643_0x301c8f(0x1e3)](a643_0x301c8f(0x1d5),Function),tslib_1[a643_0x301c8f(0x1e3)]('design:paramtypes',[Object,Object,Object]),tslib_1[a643_0x301c8f(0x1e3)](a643_0x301c8f(0x19e),Promise)],FacebookController[a643_0x301c8f(0x1b2)],a643_0x301c8f(0x1cd),null),FacebookController=tslib_1['__decorate']([(0x0,routing_controllers_1['Controller'])('/facebook-login'),tslib_1[a643_0x301c8f(0x1e3)](a643_0x301c8f(0x1a1),[])],FacebookController),exports[a643_0x301c8f(0x1ca)]=FacebookController;