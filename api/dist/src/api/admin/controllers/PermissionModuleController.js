'use strict';const a271_0x27cf5c=a271_0x2228;(function(_0x572b94,_0x433a20){const _0x2eacdc=a271_0x2228,_0x21790d=_0x572b94();while(!![]){try{const _0x17af13=-parseInt(_0x2eacdc(0xd6))/0x1*(-parseInt(_0x2eacdc(0xb0))/0x2)+-parseInt(_0x2eacdc(0xe4))/0x3*(-parseInt(_0x2eacdc(0xb8))/0x4)+-parseInt(_0x2eacdc(0x9e))/0x5+parseInt(_0x2eacdc(0xea))/0x6+parseInt(_0x2eacdc(0xe3))/0x7*(parseInt(_0x2eacdc(0xe9))/0x8)+parseInt(_0x2eacdc(0xb5))/0x9+-parseInt(_0x2eacdc(0xcd))/0xa;if(_0x17af13===_0x433a20)break;else _0x21790d['push'](_0x21790d['shift']());}catch(_0x5d734e){_0x21790d['push'](_0x21790d['shift']());}}}(a271_0x3cd1,0x5cf71));Object[a271_0x27cf5c(0xb6)](exports,a271_0x27cf5c(0xc9),{'value':!![]}),exports[a271_0x27cf5c(0xed)]=void 0x0;const tslib_1=require('tslib');function a271_0x3cd1(){const _0x73fb3e=['Req','reflect-metadata','BodyParam','__awaiter','findOne','addPermission','design:type','Successfully\x20got\x20permission\x20module\x20group\x20list\x20count','forEach','moduleGroupId','groupId','parse','42NBhrzE','80940eROvRX','__decorate','Successfully\x20got\x20permission\x20list','../../core/services/UserService','sortOrder','690008yqCgHm','306978KPSYHW','name','design:returntype','AdminPermissionController','UserService','ASC','../../core/services/PermissionModuleService','/add-permission','/list','3478715YeJVEW','UserGroupService','userGroupService','permissionModule','status','/permission-me','QueryParam','permissionMe','Authorized','userId','permissionList','Invalid\x20Reference\x20Id','/permission-module','limit','findAll','permissionModuleService','Successfully\x20got\x20permission\x20list\x20for\x20current\x20user','../../core/services/UserGroupService','27410IrSMqO','__param','user','PermissionModuleGroupService','Res','3888270dSnkwb','defineProperty','userService','64wRghiR','offset','getPermission','all','prototype','slugName','update','PermissionModuleService','moduleId','stringify','map','count','Invalid\x20token\x20ID','Current\x20user\x20permission\x20cannot\x20update','list','Post','Invalid\x20Reference\x20Id.','__esModule','__metadata','permissionModuleGroupService','design:paramtypes','9588710XFyPZS','../../core/services/PermissionModuleGroupService','refId','send','userGroupId','Get','permission','refType','usergroup','44FUvDew'];a271_0x3cd1=function(){return _0x73fb3e;};return a271_0x3cd1();}require(a271_0x27cf5c(0xd8));function a271_0x2228(_0x4ed11f,_0x1df4b1){const _0x3cd1f3=a271_0x3cd1();return a271_0x2228=function(_0x22281b,_0x2d9aee){_0x22281b=_0x22281b-0x9e;let _0x4138fd=_0x3cd1f3[_0x22281b];return _0x4138fd;},a271_0x2228(_0x4ed11f,_0x1df4b1);}const routing_controllers_1=require('routing-controllers'),PermissionModuleService_1=require(a271_0x27cf5c(0xf0)),PermissionModuleGroupService_1=require(a271_0x27cf5c(0xce)),UserGroupService_1=require(a271_0x27cf5c(0xaf)),UserService_1=require(a271_0x27cf5c(0xe7));let AdminPermissionController=class AdminPermissionController{constructor(_0x5580b6,_0x537a3c,_0x1819fd,_0x133b63){const _0x21ef73=a271_0x27cf5c;this[_0x21ef73(0xad)]=_0x5580b6,this[_0x21ef73(0xcb)]=_0x537a3c,this['userService']=_0x1819fd,this['userGroupService']=_0x133b63;}[a271_0x27cf5c(0xa8)](_0x4ebf05,_0x5dc059,_0x381c3b,_0x3b2eea){const _0x3ea6f6=a271_0x27cf5c;return tslib_1[_0x3ea6f6(0xda)](this,void 0x0,void 0x0,function*(){const _0x5365b3=_0x3ea6f6,_0x204a98=[_0x5365b3(0xe0),_0x5365b3(0xeb),'slugName',_0x5365b3(0xe8)],_0x336f06=[],_0x5ef5d4=[],_0x5cdf1e=yield this[_0x5365b3(0xcb)][_0x5365b3(0xc6)](_0x4ebf05,_0x5dc059,_0x204a98,_0x336f06,_0x5ef5d4,_0x381c3b);if(_0x381c3b){const _0x180d37={'status':0x1,'message':_0x5365b3(0xde),'data':_0x5cdf1e};return _0x3b2eea[_0x5365b3(0xa2)](0xc8)[_0x5365b3(0xd0)](_0x180d37);}const _0x5faabf=_0x5cdf1e[_0x5365b3(0xc2)](_0x4a0bb2=>tslib_1[_0x5365b3(0xda)](this,void 0x0,void 0x0,function*(){const _0x1926c5=_0x5365b3,_0x8cef41=yield this[_0x1926c5(0xad)][_0x1926c5(0xac)]({'select':[_0x1926c5(0xc0),'moduleGroupId','name',_0x1926c5(0xbd)],'where':{'moduleGroupId':_0x4a0bb2['moduleGroupId']},'orderBy':{'sortOrder':_0x1926c5(0xef)}}),_0x4885f9=_0x4a0bb2;return _0x4885f9[_0x1926c5(0xa1)]=_0x8cef41,_0x4885f9;})),_0x57c430=yield Promise[_0x5365b3(0xbb)](_0x5faabf),_0x200731={'status':0x1,'message':'Successfully\x20got\x20the\x20complete\x20list\x20of\x20pages.','data':_0x57c430};return _0x3b2eea[_0x5365b3(0xa2)](0xc8)[_0x5365b3(0xd0)](_0x200731);});}['addPermission'](_0x237c50,_0x369aee,_0x3e1148,_0x4e7a8c,_0x40b6d7){const _0x50d274=a271_0x27cf5c;return tslib_1[_0x50d274(0xda)](this,void 0x0,void 0x0,function*(){const _0x24b4cc=_0x50d274,_0xead57c=yield this['userService']['findOne']({'where':{'userId':_0x40b6d7['user'][_0x24b4cc(0xa7)],'deleteFlag':0x0},'relations':[_0x24b4cc(0xd5)]}),_0x96a98d=yield this['permissionModuleService'][_0x24b4cc(0xc6)](0x0,0x0,[],[],[],![]),_0x319954={},_0x5c98f=_0x3e1148?JSON[_0x24b4cc(0xe2)](_0x3e1148):{};_0x96a98d[_0x24b4cc(0xdf)](_0x1d2fa3=>{const _0x18c7fe=_0x24b4cc;_0x5c98f['indexOf'](_0x1d2fa3[_0x18c7fe(0xbd)])!==-0x1?_0x319954[_0x1d2fa3['slugName']]=!![]:_0x319954[_0x1d2fa3[_0x18c7fe(0xbd)]]=![];});let _0x30f6a0;if(_0x237c50&&+_0x237c50===0x1){const _0x171795=yield this[_0x24b4cc(0xa0)][_0x24b4cc(0xdb)]({'where':{'groupId':_0x369aee}});if(!_0x171795){const _0x34a16a={'status':0x0,'message':'Invalid\x20Reference\x20Id.'};return _0x4e7a8c[_0x24b4cc(0xa2)](0x190)[_0x24b4cc(0xd0)](_0x34a16a);}if(_0xead57c){if(_0xead57c[_0x24b4cc(0xd1)]===_0x171795[_0x24b4cc(0xe1)]){const _0x5150c8={'status':0x0,'message':'You\x20cannot\x20update\x20the\x20role\x20as\x20currently\x20the\x20user\x20is\x20mapped\x20to\x20it.'};return _0x4e7a8c[_0x24b4cc(0xa2)](0x190)[_0x24b4cc(0xd0)](_0x5150c8);}}_0x171795[_0x24b4cc(0xd3)]=JSON[_0x24b4cc(0xc1)](_0x319954),_0x30f6a0=yield this[_0x24b4cc(0xa0)][_0x24b4cc(0xbe)](_0x369aee,_0x171795);}else{if(_0x237c50&&+_0x237c50===0x2){const _0x2e3a32=yield this[_0x24b4cc(0xb7)][_0x24b4cc(0xdb)]({'where':{'userId':_0x369aee}});if(!_0x2e3a32){const _0x3bab72={'status':0x0,'message':_0x24b4cc(0xc8)};return _0x4e7a8c[_0x24b4cc(0xa2)](0x190)[_0x24b4cc(0xd0)](_0x3bab72);}if(_0x40b6d7['user'][_0x24b4cc(0xa7)]===_0x369aee){const _0x292bae={'status':0x0,'message':_0x24b4cc(0xc5)};return _0x4e7a8c[_0x24b4cc(0xa2)](0x190)[_0x24b4cc(0xd0)](_0x292bae);}_0x2e3a32[_0x24b4cc(0xd3)]=JSON[_0x24b4cc(0xc1)](_0x319954),_0x30f6a0=yield this[_0x24b4cc(0xb7)][_0x24b4cc(0xbe)](_0x369aee,_0x2e3a32);}}const _0x3de3d6={'status':0x1,'message':'Successfully\x20updated\x20the\x20permission.','data':_0x30f6a0};return _0x4e7a8c[_0x24b4cc(0xa2)](0xc8)[_0x24b4cc(0xd0)](_0x3de3d6);});}['getPermission'](_0x5bdb1c,_0x216a31,_0x14bba3){const _0x2aa308=a271_0x27cf5c;return tslib_1[_0x2aa308(0xda)](this,void 0x0,void 0x0,function*(){const _0x147d0b=_0x2aa308;let _0x220873;if(_0x5bdb1c&&+_0x5bdb1c===0x1){const _0xad66f8=yield this[_0x147d0b(0xa0)][_0x147d0b(0xdb)]({'where':{'groupId':_0x216a31}});if(!_0xad66f8){const _0x25e0b1={'status':0x0,'message':_0x147d0b(0xa9)};return _0x14bba3[_0x147d0b(0xa2)](0x190)[_0x147d0b(0xd0)](_0x25e0b1);}_0x220873=_0xad66f8[_0x147d0b(0xd3)]?JSON[_0x147d0b(0xe2)](_0xad66f8[_0x147d0b(0xd3)]):{};}else{if(_0x5bdb1c&&+_0x5bdb1c===0x2){const _0x138a83=yield this[_0x147d0b(0xb7)][_0x147d0b(0xdb)]({'where':{'userId':_0x216a31}});if(!_0x138a83){const _0x15dfc4={'status':0x0,'message':_0x147d0b(0xa9)};return _0x14bba3[_0x147d0b(0xa2)](0x190)['send'](_0x15dfc4);}if(_0x138a83[_0x147d0b(0xd3)])_0x220873=_0x138a83[_0x147d0b(0xd3)]?JSON[_0x147d0b(0xe2)](_0x138a83[_0x147d0b(0xd3)]):{};else{const _0x447a62=yield this[_0x147d0b(0xa0)]['findOne']({'where':{'groupId':_0x138a83[_0x147d0b(0xd1)]}});_0x220873=_0x447a62[_0x147d0b(0xd3)]?JSON[_0x147d0b(0xe2)](_0x447a62[_0x147d0b(0xd3)]):{};}}}const _0xa7351e={'status':0x1,'message':_0x147d0b(0xe6),'data':_0x220873};return _0x14bba3[_0x147d0b(0xa2)](0xc8)['send'](_0xa7351e);});}[a271_0x27cf5c(0xa5)](_0x28d72c,_0x35a9c7){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function*(){const _0xb39e38=a271_0x2228,_0x31daad=yield this[_0xb39e38(0xb7)]['findOne']({'where':{'userId':_0x28d72c[_0xb39e38(0xb2)][_0xb39e38(0xa7)],'deleteFlag':0x0},'relations':[_0xb39e38(0xd5)]});if(_0x31daad){let _0x556cb6={};if(_0x31daad[_0xb39e38(0xd1)]!==0x1){const _0x576795=yield this['userService']['findOne']({'where':{'userId':_0x31daad[_0xb39e38(0xa7)]}});if(_0x576795[_0xb39e38(0xd3)])_0x556cb6=JSON['parse'](_0x576795['permission']);else{const _0x4d63a1=yield this['userGroupService'][_0xb39e38(0xdb)]({'where':{'groupId':_0x31daad['userGroupId']}});_0x556cb6=_0x4d63a1[_0xb39e38(0xd3)]?JSON[_0xb39e38(0xe2)](_0x4d63a1[_0xb39e38(0xd3)]):{};}}const _0x58abb4={'status':0x1,'message':_0xb39e38(0xae),'data':_0x556cb6};return _0x35a9c7[_0xb39e38(0xa2)](0xc8)[_0xb39e38(0xd0)](_0x58abb4);}const _0x2db1c2={'status':0x0,'message':_0xb39e38(0xc4)};return _0x35a9c7[_0xb39e38(0xa2)](0x190)['send'](_0x2db1c2);});}};tslib_1[a271_0x27cf5c(0xe5)]([(0x0,routing_controllers_1[a271_0x27cf5c(0xd2)])(a271_0x27cf5c(0xf2)),(0x0,routing_controllers_1[a271_0x27cf5c(0xa6)])(),tslib_1[a271_0x27cf5c(0xb1)](0x0,(0x0,routing_controllers_1['QueryParam'])(a271_0x27cf5c(0xab))),tslib_1['__param'](0x1,(0x0,routing_controllers_1['QueryParam'])(a271_0x27cf5c(0xb9))),tslib_1[a271_0x27cf5c(0xb1)](0x2,(0x0,routing_controllers_1[a271_0x27cf5c(0xa4)])(a271_0x27cf5c(0xc3))),tslib_1[a271_0x27cf5c(0xb1)](0x3,(0x0,routing_controllers_1['Res'])()),tslib_1['__metadata'](a271_0x27cf5c(0xdd),Function),tslib_1['__metadata'](a271_0x27cf5c(0xcc),[Number,Number,Object,Object]),tslib_1[a271_0x27cf5c(0xca)]('design:returntype',Promise)],AdminPermissionController[a271_0x27cf5c(0xbc)],a271_0x27cf5c(0xa8),null),tslib_1['__decorate']([(0x0,routing_controllers_1[a271_0x27cf5c(0xc7)])(a271_0x27cf5c(0xf1)),(0x0,routing_controllers_1['Authorized'])(),tslib_1[a271_0x27cf5c(0xb1)](0x0,(0x0,routing_controllers_1[a271_0x27cf5c(0xd9)])(a271_0x27cf5c(0xd4))),tslib_1['__param'](0x1,(0x0,routing_controllers_1[a271_0x27cf5c(0xd9)])(a271_0x27cf5c(0xcf))),tslib_1['__param'](0x2,(0x0,routing_controllers_1['BodyParam'])(a271_0x27cf5c(0xd3))),tslib_1[a271_0x27cf5c(0xb1)](0x3,(0x0,routing_controllers_1[a271_0x27cf5c(0xb4)])()),tslib_1['__param'](0x4,(0x0,routing_controllers_1['Req'])()),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xdd),Function),tslib_1['__metadata'](a271_0x27cf5c(0xcc),[Number,Number,String,Object,Object]),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xec),Promise)],AdminPermissionController[a271_0x27cf5c(0xbc)],a271_0x27cf5c(0xdc),null),tslib_1[a271_0x27cf5c(0xe5)]([(0x0,routing_controllers_1['Get'])('/get-permission'),(0x0,routing_controllers_1[a271_0x27cf5c(0xa6)])(),tslib_1[a271_0x27cf5c(0xb1)](0x0,(0x0,routing_controllers_1[a271_0x27cf5c(0xa4)])(a271_0x27cf5c(0xd4))),tslib_1[a271_0x27cf5c(0xb1)](0x1,(0x0,routing_controllers_1['QueryParam'])(a271_0x27cf5c(0xcf))),tslib_1[a271_0x27cf5c(0xb1)](0x2,(0x0,routing_controllers_1[a271_0x27cf5c(0xb4)])()),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xdd),Function),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xcc),[Number,Number,Object]),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xec),Promise)],AdminPermissionController[a271_0x27cf5c(0xbc)],a271_0x27cf5c(0xba),null),tslib_1[a271_0x27cf5c(0xe5)]([(0x0,routing_controllers_1[a271_0x27cf5c(0xd2)])(a271_0x27cf5c(0xa3)),(0x0,routing_controllers_1[a271_0x27cf5c(0xa6)])(),tslib_1[a271_0x27cf5c(0xb1)](0x0,(0x0,routing_controllers_1[a271_0x27cf5c(0xd7)])()),tslib_1[a271_0x27cf5c(0xb1)](0x1,(0x0,routing_controllers_1[a271_0x27cf5c(0xb4)])()),tslib_1['__metadata'](a271_0x27cf5c(0xdd),Function),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xcc),[Object,Object]),tslib_1[a271_0x27cf5c(0xca)]('design:returntype',Promise)],AdminPermissionController['prototype'],'permissionMe',null),AdminPermissionController=tslib_1[a271_0x27cf5c(0xe5)]([(0x0,routing_controllers_1['JsonController'])(a271_0x27cf5c(0xaa)),tslib_1[a271_0x27cf5c(0xca)](a271_0x27cf5c(0xcc),[PermissionModuleService_1[a271_0x27cf5c(0xbf)],PermissionModuleGroupService_1[a271_0x27cf5c(0xb3)],UserService_1[a271_0x27cf5c(0xee)],UserGroupService_1[a271_0x27cf5c(0x9f)]])],AdminPermissionController),exports['AdminPermissionController']=AdminPermissionController;