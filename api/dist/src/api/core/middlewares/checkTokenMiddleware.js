'use strict';const a360_0x1b4492=a360_0x91a4;(function(_0x3d0237,_0x54612c){const _0x118537=a360_0x91a4,_0x1f4e3b=_0x3d0237();while(!![]){try{const _0x1c9259=-parseInt(_0x118537(0x1e8))/0x1+parseInt(_0x118537(0x1f5))/0x2*(parseInt(_0x118537(0x210))/0x3)+-parseInt(_0x118537(0x202))/0x4*(parseInt(_0x118537(0x1f2))/0x5)+-parseInt(_0x118537(0x1e9))/0x6+-parseInt(_0x118537(0x1f7))/0x7*(parseInt(_0x118537(0x1ec))/0x8)+-parseInt(_0x118537(0x212))/0x9+parseInt(_0x118537(0x20f))/0xa;if(_0x1c9259===_0x54612c)break;else _0x1f4e3b['push'](_0x1f4e3b['shift']());}catch(_0x3d6c30){_0x1f4e3b['push'](_0x1f4e3b['shift']());}}}(a360_0x2d28,0xb5613));Object[a360_0x1b4492(0x1ee)](exports,a360_0x1b4492(0x1ed),{'value':!![]}),exports[a360_0x1b4492(0x20a)]=exports[a360_0x1b4492(0x211)]=void 0x0;const tslib_1=require(a360_0x1b4492(0x1eb)),env_1=require(a360_0x1b4492(0x1f3)),Customer_1=require(a360_0x1b4492(0x208)),AccessTokenModel_1=require(a360_0x1b4492(0x20e)),typeorm_1=require(a360_0x1b4492(0x206));function CheckTokenMiddleware(_0xbff3f3,_0x26bf87,_0x48fdd9){const _0x98e817=a360_0x1b4492,_0xf23c7b=(0x0,typeorm_1['getManager'])()['getRepository'](Customer_1[_0x98e817(0x204)]),_0x1b7269=(0x0,typeorm_1[_0x98e817(0x1f9)])()[_0x98e817(0x1f1)](AccessTokenModel_1[_0x98e817(0x205)]),_0xe996fa=require('jsonwebtoken'),_0x495a9f=_0xbff3f3[_0x98e817(0x200)]('authorization');if(_0x495a9f){const _0x367acf=_0x495a9f['split']('\x20')[0x1],_0x31555b=require(_0x98e817(0x1f8)),_0x499637=_0x31555b[_0x98e817(0x1f0)][_0x98e817(0x1fc)](_0x367acf,env_1['env'][_0x98e817(0x1ff)]),_0x196d26=_0x499637[_0x98e817(0x1fa)](_0x31555b[_0x98e817(0x20d)][_0x98e817(0x207)]);_0xe996fa[_0x98e817(0x1fe)](_0x196d26,env_1[_0x98e817(0x203)][_0x98e817(0x1ef)],(_0x30572b,_0x20f5ac)=>tslib_1[_0x98e817(0x1fd)](this,void 0x0,void 0x0,function*(){const _0x41bf6f=_0x98e817;if(_0x30572b)_0xbff3f3['id']='',_0x48fdd9();else{const _0x1488fc=yield _0x1b7269[_0x41bf6f(0x20b)]({'where':{'token':_0x196d26}});if(_0x1488fc){const _0x577861=yield _0xf23c7b[_0x41bf6f(0x20b)]({'where':{'id':_0x20f5ac['id'],'deleteFlag':0x0,'isActive':0x1}});if(_0x577861)_0xbff3f3['id']=_0x577861['id'],_0x48fdd9();else return _0x26bf87['status'](0x191)[_0x41bf6f(0x1ea)]({'status':0x0,'message':'UnAuthorized\x20user'});}else _0xbff3f3['id']='',_0x48fdd9();}}));}else _0xbff3f3['id']='',_0x48fdd9();}function a360_0x91a4(_0x3ace1a,_0x3ba9cf){const _0x2d28a0=a360_0x2d28();return a360_0x91a4=function(_0x91a490,_0x335c1d){_0x91a490=_0x91a490-0x1e8;let _0x2c3184=_0x2d28a0[_0x91a490];return _0x2c3184;},a360_0x91a4(_0x3ace1a,_0x3ba9cf);}exports['CheckTokenMiddleware']=CheckTokenMiddleware;function CheckCustomerMiddleware(_0x554eb7,_0xa7981b,_0x4ace06){const _0x161f15=a360_0x1b4492,_0xee7bbe=require(_0x161f15(0x1fb)),_0x396b6b=_0x554eb7[_0x161f15(0x200)]('authorization'),_0x95ae32=(0x0,typeorm_1[_0x161f15(0x1f9)])()['getRepository'](Customer_1[_0x161f15(0x204)]),_0x3d842c=(0x0,typeorm_1[_0x161f15(0x1f9)])()['getRepository'](AccessTokenModel_1[_0x161f15(0x205)]);if(_0x396b6b){const _0x16e198=_0x396b6b[_0x161f15(0x209)]('\x20')[0x1],_0x512cbc=require('crypto-js'),_0x4a1973=_0x512cbc['AES'][_0x161f15(0x1fc)](_0x16e198,env_1[_0x161f15(0x203)][_0x161f15(0x1ff)]),_0x3dbe83=_0x4a1973[_0x161f15(0x1fa)](_0x512cbc[_0x161f15(0x20d)][_0x161f15(0x207)]);_0xee7bbe[_0x161f15(0x1fe)](_0x3dbe83,env_1['env']['jwtSecret'],(_0x459c25,_0x3c4ea1)=>tslib_1[_0x161f15(0x1fd)](this,void 0x0,void 0x0,function*(){const _0x203328=_0x161f15;if(_0x459c25)return _0xa7981b[_0x203328(0x201)](0x191)[_0x203328(0x1ea)]({'status':0x0,'message':_0x203328(0x1f4)});else{const _0x583045=yield _0x3d842c[_0x203328(0x20b)]({'where':{'token':_0x3dbe83}});if(_0x583045){const _0x75c770=yield _0x95ae32[_0x203328(0x20b)]({'where':{'id':_0x3c4ea1['id'],'deleteFlag':0x0,'isActive':0x1}});if(_0x75c770)_0x554eb7[_0x203328(0x1f6)]=_0x75c770,_0x4ace06();else return _0xa7981b[_0x203328(0x201)](0x191)[_0x203328(0x1ea)]({'status':0x0,'message':_0x203328(0x20c)});}else return _0xa7981b['status'](0x191)['send']({'status':0x0,'message':_0x203328(0x20c)});}}));}else return _0xa7981b[_0x161f15(0x201)](0x191)[_0x161f15(0x1ea)]({'status':0x0,'message':_0x161f15(0x20c)});}function a360_0x2d28(){const _0x52a23d=['jwtSecret','AES','getRepository','2625qcaUSF','../../../env','Please\x20send\x20a\x20valid\x20token','2jSZdoW','user','8628235nTktoD','crypto-js','getManager','toString','jsonwebtoken','decrypt','__awaiter','verify','cryptoSecret','header','status','3316LgvnDr','env','Customer','AccessToken','typeorm','Utf8','../models/Customer','split','CheckCustomerMiddleware','findOne','UnAuthorized\x20user','enc','../models/AccessTokenModel','29147650peJalt','929262OsQuwP','CheckTokenMiddleware','1483029Borydz','247027HzGhoy','2411700EpcrHG','send','tslib','8nyxFiE','__esModule','defineProperty'];a360_0x2d28=function(){return _0x52a23d;};return a360_0x2d28();}exports[a360_0x1b4492(0x20a)]=CheckCustomerMiddleware;